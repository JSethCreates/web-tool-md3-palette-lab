<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Material 3 Palette Generator</title>
  <style>
    body { font-family: sans-serif; background: #f5f5f5; padding: 2em; }
    input { margin-bottom: 1em; }
    #colorPreview { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 0.5em; margin-bottom: 1em; }
    #colorPreview .swatch { font-size: 0.75em; font-weight: bold; text-align: center; padding: 1em; border: 1px solid #ccc; border-radius: 4px; }
    textarea { width: 100%; height: 300px; }
  </style>
</head>
<body>
  <h1>Material 3 Palette Generator</h1>
  <label for="primaryColor">Primary Color:</label>
  <input type="color" id="primaryColor" value="#6750A4" /><br />

  <label for="secondaryColor">Optional Secondary Color:</label>
  <input type="text" id="secondaryColor" value="#03dac5" /><br />

  <button id="generateBtn">Generate Palette</button>
  <div id="colorPreview"></div>
  <textarea id="output" readonly></textarea>

  <script type="module">
    console.log("ðŸŸ¢ Script loaded, waiting for click...");

    import { argbFromHex, hexFromArgb, themeFromSourceColor } from 'https://unpkg.com/@material/material-color-utilities';

    const logicalOrder = [
      "--md-sys-color-primary",
      "--md-sys-color-on-primary",
      "--md-sys-color-primary-container",
      "--md-sys-color-on-primary-container",

      "--md-sys-color-secondary",
      "--md-sys-color-on-secondary",
      "--md-sys-color-secondary-container",
      "--md-sys-color-on-secondary-container",

      "--md-sys-color-surface",
      "--md-sys-color-on-surface",
      "--md-sys-color-surface-variant",
      "--md-sys-color-on-surface-variant",

      "--md-sys-color-surface-container-low",
      "--md-sys-color-surface-container",
      "--md-sys-color-surface-container-high",

      "--md-sys-color-outline",

      "--bg-color",
      "--indicator-bg",
      "--transparent-bg"
    ];

    document.getElementById('generateBtn').addEventListener('click', () => {
      console.log("âš¡ Generate button clicked");
      const primary = document.getElementById('primaryColor').value;
      const secondary = document.getElementById('secondaryColor').value;

      const theme = themeFromSourceColor(argbFromHex(primary));
      if (secondary) {
        theme.customColors = [{ color: argbFromHex(secondary), name: "customSecondary", blend: true }];
        console.log("ðŸŽ¨ Secondary color applied");
      }

      const scheme = theme.schemes.light;
      const out = {
        "--md-sys-color-primary": hexFromArgb(scheme.primary),
        "--md-sys-color-on-primary": hexFromArgb(scheme.onPrimary),
        "--md-sys-color-primary-container": hexFromArgb(scheme.primaryContainer),
        "--md-sys-color-on-primary-container": hexFromArgb(scheme.onPrimaryContainer),
        "--md-sys-color-secondary": hexFromArgb(scheme.secondary),
        "--md-sys-color-on-secondary": hexFromArgb(scheme.onSecondary),
        "--md-sys-color-secondary-container": hexFromArgb(scheme.secondaryContainer),
        "--md-sys-color-on-secondary-container": hexFromArgb(scheme.onSecondaryContainer),
        "--md-sys-color-surface": hexFromArgb(scheme.surface),
        "--md-sys-color-on-surface": hexFromArgb(scheme.onSurface),
        "--md-sys-color-surface-variant": hexFromArgb(scheme.surfaceVariant),
        "--md-sys-color-on-surface-variant": hexFromArgb(scheme.onSurfaceVariant),
        "--md-sys-color-surface-container-low": hexFromArgb(theme.schemes.light.surfaceContainerLow),
        "--md-sys-color-surface-container": hexFromArgb(theme.schemes.light.surfaceContainer),
        "--md-sys-color-surface-container-high": hexFromArgb(theme.schemes.light.surfaceContainerHigh),
        "--md-sys-color-outline": hexFromArgb(scheme.outline),
        "--bg-color": "#18181849",
        "--indicator-bg": "#10101094",
        "--transparent-bg": "#10101000"
      };

      const preview = document.getElementById('colorPreview');
      const outputBox = document.getElementById('output');
      preview.innerHTML = '';
      let output = '';

      logicalOrder.forEach((key) => {
        const val = out[key];
        if (!val) return;
        output += `${key}: ${val};\n`;
        const swatch = document.createElement('div');
        swatch.className = 'swatch';
        swatch.style.background = val;
        const r = parseInt(val.slice(1, 3), 16);
        const g = parseInt(val.slice(3, 5), 16);
        const b = parseInt(val.slice(5, 7), 16);
        const brightness = 0.299 * r + 0.587 * g + 0.114 * b;
        swatch.style.color = brightness > 140 ? 'black' : 'white';
        swatch.textContent = key;
        preview.appendChild(swatch);
      });

      outputBox.value = output;
      console.log("âœ… Palette generated");
    });
  </script>
</body>
</html>
